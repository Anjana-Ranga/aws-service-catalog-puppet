
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Getting up and running &#8212; aws-service-catalog-puppet  documentation</title>
    <link rel="stylesheet" href="../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="&lt;no title&gt;" href="designing_your_manifest.html" />
    <link rel="prev" title="What is this?" href="what_is_this.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="designing_your_manifest.html" title="&lt;no title&gt;"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="what_is_this.html" title="What is this?"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">aws-service-catalog-puppet  documentation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="getting-up-and-running">
<h1>Getting up and running<a class="headerlink" href="#getting-up-and-running" title="Permalink to this headline">¶</a></h1>
<p>ServiceCatalog-Puppet runs in your AWS Account.  In order for you to install it into your account you can use the
aws-service-catalog-puppet cli.  This is distributed via <a class="reference external" href="https://pypi.org/project/aws-service-catalog-puppet/">PyPi</a></p>
<div class="section" id="before-you-install">
<h2>Before you install<a class="headerlink" href="#before-you-install" title="Permalink to this headline">¶</a></h2>
<p>You should consider which account will be the home for your puppet.  This account will contain the AWS CodePipelines
and will need to be accessible to any accounts you would like to share with.  If you are using ServiceCatalog-Factory,
we recommend you install both tools into the same account.</p>
</div>
<div class="section" id="installing-the-tool">
<h2>Installing the tool<a class="headerlink" href="#installing-the-tool" title="Permalink to this headline">¶</a></h2>
<p>This is a python cli built using Python 3.</p>
<p>It is good practice to install Python libraries in isolated environments.  You can create the a virtual environment using
the following command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>virtualenv --python<span class="o">=</span>python3.7 venv
<span class="nb">source</span> venv/bin/activate
</pre></div>
</div>
<p>Once you have decided where to install the library you can install the package:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip install aws-service-catalog-puppet
</pre></div>
</div>
<p>This will install the library and all of the dependencies.</p>
</div>
<div class="section" id="setting-it-up">
<h2>Setting it up<a class="headerlink" href="#setting-it-up" title="Permalink to this headline">¶</a></h2>
<p>The Puppet will run in your account and needs some configuration.  You will need to stand up the puppet and set up the
configuration for it to run smoothly.</p>
<p>You will also need to provision an IAM Role within the <em>spoke</em> accounts - those you want to provision products in.</p>
<div class="section" id="bootstrap-your-spokes">
<h3>Bootstrap your spokes<a class="headerlink" href="#bootstrap-your-spokes" title="Permalink to this headline">¶</a></h3>
<p>Set up your spoke accounts:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>servicecatalog-puppet bootstrap-spoke &lt;ACCOUNT_ID_OF_YOUR_PUPPET&gt;
</pre></div>
</div>
</div>
<div class="section" id="bootstrap-your-account">
<h3>Bootstrap your account<a class="headerlink" href="#bootstrap-your-account" title="Permalink to this headline">¶</a></h3>
<p>There are two parts to bootstrapping the puppet.  The first is concerned with setting the global configurations.  To do
this we use AWS SSM Parameters.  To get setup you need to create a configuration file with a list of regions you want to
use - for example config.yaml:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">regions</span><span class="p">:</span> <span class="p p-Indicator">[</span>
  <span class="s">&#39;us-east-2&#39;</span><span class="p p-Indicator">,</span>
  <span class="s">&#39;us-east-1&#39;</span><span class="p p-Indicator">,</span>
  <span class="s">&#39;us-west-1&#39;</span><span class="p p-Indicator">,</span>
  <span class="s">&#39;us-west-2&#39;</span><span class="p p-Indicator">,</span>
  <span class="s">&#39;ap-south-1&#39;</span><span class="p p-Indicator">,</span>
  <span class="s">&#39;ap-northeast-2&#39;</span><span class="p p-Indicator">,</span>
  <span class="s">&#39;ap-southeast-1&#39;</span><span class="p p-Indicator">,</span>
  <span class="s">&#39;ap-southeast-2&#39;</span><span class="p p-Indicator">,</span>
  <span class="s">&#39;ap-northeast-1&#39;</span><span class="p p-Indicator">,</span>
  <span class="s">&#39;ca-central-1&#39;</span><span class="p p-Indicator">,</span>
  <span class="s">&#39;eu-central-1&#39;</span><span class="p p-Indicator">,</span>
  <span class="s">&#39;eu-west-1&#39;</span><span class="p p-Indicator">,</span>
  <span class="s">&#39;eu-west-2&#39;</span><span class="p p-Indicator">,</span>
  <span class="s">&#39;eu-west-3&#39;</span><span class="p p-Indicator">,</span>
  <span class="s">&#39;sa-east-1&#39;</span><span class="p p-Indicator">,</span>
<span class="p p-Indicator">]</span>
</pre></div>
</div>
<p>Once you have this file you need to upload the config:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>servicecatalog-puppet upload-config config.yaml
</pre></div>
</div>
<p>If you make changes to this you will need to run upload-config and bootstrap commands again for the changes to occur.</p>
<p>Once that has completed you are ready to bring up the rest of the puppet.</p>
<p>Create the AWS CodeCommit repo and AWS CodePipeline resources to run the puppet for your
master account:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>servicecatalog-puppet bootstrap
</pre></div>
</div>
</div>
<div class="section" id="setup-your-puppet">
<h3>Setup your puppet<a class="headerlink" href="#setup-your-puppet" title="Permalink to this headline">¶</a></h3>
<p>Clone the configuration repo and configure your factory:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>git clone --config <span class="s1">&#39;credential.helper=!aws codecommit credential-helper $@&#39;</span> --config <span class="s1">&#39;credential.UseHttpPath=true&#39;</span> https://git-codecommit.eu-west-1.amazonaws.com/v1/repos/ServiceCatalogPuppet
servicecatalog-puppet seed simple ServiceCatalogPuppet
<span class="nb">cd</span> ServiceCatalogPuppet
git add .
git commit -am <span class="s2">&quot;initial add&quot;</span>
git push
</pre></div>
</div>
<p>Wait for pipeline to complete and you have a working puppet.</p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Getting up and running</a><ul>
<li><a class="reference internal" href="#before-you-install">Before you install</a></li>
<li><a class="reference internal" href="#installing-the-tool">Installing the tool</a></li>
<li><a class="reference internal" href="#setting-it-up">Setting it up</a><ul>
<li><a class="reference internal" href="#bootstrap-your-spokes">Bootstrap your spokes</a></li>
<li><a class="reference internal" href="#bootstrap-your-account">Bootstrap your account</a></li>
<li><a class="reference internal" href="#setup-your-puppet">Setup your puppet</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="what_is_this.html"
                        title="previous chapter">What is this?</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="designing_your_manifest.html"
                        title="next chapter">&lt;no title&gt;</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/puppet/getting_up_and_running.md.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="designing_your_manifest.html" title="&lt;no title&gt;"
             >next</a> |</li>
        <li class="right" >
          <a href="what_is_this.html" title="What is this?"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">aws-service-catalog-puppet  documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2019, Eamonn Faherty.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.0.0.
    </div>
  </body>
</html>